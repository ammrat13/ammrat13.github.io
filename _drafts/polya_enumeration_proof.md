---
title: A Proof of P贸lya's Enumeration Theorem
libs: [mathjax]
---

<div class="mathjaxDeclarations">
    @@\newcommand{\nl}{\\}@@
    @@\newcommand{\cyc}[1]{\text{NumCycles}(#1)}@@
    @@\newcommand{\Stab}[1]{\text{Stab}(#1)}@@
    @@\newcommand{\Orb}[1]{\text{Orb}(#1)}@@
</div>

This semester, I took [MATH 3012](http://math.gatech.edu/courses/math/3012), a
discrete math course with Dr. Ernest Croot. It was an interesting class,
especially because discrete structures aren't discussed heavily in high-school
and early college math, despite them being a core part of computer science.

Until now, my main exposure to discrete math had been through math competitions,
and I was kind of bad at them. The counting problems always messed me up (since
I never practiced them). As such, combinatorics has always held a special place
in my heart --- a field of math that's widely applicable, but one that I'm not
good at.

Dr. Croot began the course by showing us a wide variety of problems in the
domain of discrete math. Stuff like simple counting problems, stars and bars,
graph coloring, the travelling salesman problem,&nbsp;&hellip;&nbsp;. One
problem he mentioned was counting colorings in the presence of symmetry. He gave
the example of a necklace and counting the distinct colorings on it with
rotational symmetry. I think he did an example with @@k@@ colors and @@3@@
beads, deriving the formula:

%% \frac{k^3 - k}{3} + k. %%

The first term counts the colorings where all the beads aren't the same color,
each generating three equivalent arrangements. The second term enumerates those
colorings where all beads are the same, where the coloring is thus invariant
under rotation.

Dr. Croot then asked us to think about the equivalent formulas for non-prime
numbers of beads, or when we allow for reflection. If the derivation in this
simple case was so complicated, just imagine how bad those would be! Just look
at the example below: four beads and two colors with a flip along the vertical
as symmetry. The case of two beads of each color is particularly ugly.
![The case of four beads and two colors under reflection](/assets/2020/12/13/colorings_reflection.svg)

My professor mentioned P贸lya's Enumeration Theorem as an easier way. I noticed a
chapter of the same name in the textbook as well, though it was quite late in
the book and we wouldn't get around to it.

---

My gut reaction for finding a plan of attack was group theory. I read through
Nathan Carter's [*Visual Group Theory*](http://books.google.com?id=F_H3DwAAQBAJ)
last semester, and I was surprised as to how ubiquitous groups really are. Since
they, in some sense, represent the symmetry of a system, it felt intuitive to
look at this problem through the lens of group theory.

In particular, it felt like a good idea to look at all the subgroups of the
relevant symmetry group @@G@@. For a particular subgroup @@H@@, we might color
all the elements of a particular coset the same color, ensuring that not all
cosets share the same color. We would thus count (for @@k@@ colors)
%% \frac{k^{[G:H]} - k}{[G:H]} %%
distinct colorings for @@H \neq G@@, and @@1@@ otherwise.

There are several problems with this. First, we'd require that @@H \triangleleft
G@@ for this to work. We'd also have to somehow sum over all the normal
subgroups of @@G@@, which becomes difficult when subgroups contain each other.
But worst of all, it's not even counting the right thing! We need to count with
respect to the objects @@G@@ acts on, not @@G@@ itself!

Nonetheless, the idea of using group theory was a good one. Indeed, P贸lya's
theorem is formulated in terms of it. The proof considers a group @@G@@ acting
on a set @@X@@. It then takes @@G@@ to act on the set of its @@k@@-colorings
@@[k]^X@@ in the following way. For @@c \in [k]^X@@, we take @@g \cdot c@@ to
color @@g \cdot x@@ the same way @@c@@ colored @@x@@. That is, @@g \in G@@ can
be seen as "shuffling" the elements of @@X@@, so we shuffle the colors alongside
their associated elements.

We'll consider two colorings the same if they differ only by an action in @@G@@,
and we want to count the number of distinct colorings in @@[k]^X@@. P贸lya's
Enumeration Theorem asserts that the number we're after is
%% \left|[k]^X/G\right| = \frac{1}{|G|}\sum_{g \in G} k^{\cyc{g}}, %%
where @@\cyc{g}@@ first considers @@g@@ as a permutation on the elements of
@@X@@ (where @@x \mapsto g \cdot x@@), then counts how many cycles it has.
Remember that all permutations can be decomposed into a product of cycles.

This result, to me, is quite odd. It's summing over all the elements of @@G@@,
even if the subgroups generated by them overlap. I'd think the sum would
overcount, and it does by exactly a factor of @@|G|@@, which is strange to me.
It's even stranger that the proof is so simple. The [Wikipedia
Article](https://en.wikipedia.org/wiki/P%C3%B3lya_enumeration_theorem) says the
theorem derives from Burnside's Lemma, which itself is a simple application of
the Orbit-Stabilizer Theorem.

---

Orbit-Stabilizer was covered in *Visual Group Theory*, but I forgot the proof
and (genuinely) had a fun time rediscovering it. It seems that, for a fixed @@x
\in X@@, we give a bijection from the *left* cosets of @@\Stab{x}@@ to the
elements of @@\Orb{x}@@, thus showing @@|\Orb{x}|=[G:\Stab{x}]@@. We create this
function in the most natural way possible: the coset @@g\cdot\Stab{x}@@ maps to
the object @@g \cdot x@@.

This is indeed a function. If @@g\cdot\Stab{x}=h\cdot\Stab{x}@@, then
@@h^{-1}g\cdot\Stab{x}=\Stab{x}@@. From here it follows that @@h^{-1}g@@
stabilizes @@x@@, so @@g@@ and @@h@@ act on @@x@@ in the same way. The argument
can be reversed to show that this function is injective --- if @@g \cdot x = h
\cdot x@@, then they give the same coset of @@\Stab{x}@@. Finally,
surjectiveness is clear since any @@g \cdot x \in \Orb{x}@@ is mapped to by
@@g\cdot\Stab{x}@@.

---

Burnside's Lemma really is a simple application of Orbit-Stabilizer once you
know what to look for. I didn't see it initially, however. For some reason, I
tried to prove that all elements of @@\Orb{x}@@ share the same stabilizing
subgroup. I think I wanted to consider @@G/\Stab{x}@@ as the orbit's
corresponding "orbiting subgroup" and do something with that. Of course, this
would require showing that @@\Stab{x} \triangleleft G@@, but it turns out that's
equivalent to all elements sharing the same stabilizer. Why? Consider all @@s
\in \Stab{x}@@ and note that @@g^{-1}sg \cdot x = x@@ if and only if @@sg \cdot
x = g \cdot x@@.

But it doesn't matter since this statement is blatantly false. The [Wikipedia
Article](https://en.wikipedia.org/wiki/Group_action#Orbits_and_stabilizers) on
Group Actions states that
> This is a subgroup of G, though typically not a normal one.
